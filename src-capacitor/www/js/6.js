(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"59a8":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page-container",[i("q-page",{staticClass:"bg-dark text-white"},[i("q-toolbar",{staticClass:"z-max"},[i("q-btn",{attrs:{dense:"",flat:"","aria-label":"Back",icon:"arrow_back"},on:{click:function(e){return t.$router.go(-1)}}}),i("q-space"),t.cropped?i("q-btn",{staticClass:"q-mb-xs",attrs:{color:"accent",label:t.filter.filters[t.filter.index]},on:{click:function(e){t.filter.index=t.filter.filters[t.filter.index+1]?t.filter.index+1:0}}}):i("div",{staticClass:"absolute-center text-body1"},[t._v("\n        Cortar imagem\n      ")]),i("q-space"),t.cropped?i("q-btn",{attrs:{dense:"",round:"",color:"positive","aria-label":"Send",icon:"send"},on:{click:t.send}}):i("q-btn",{staticStyle:{"margin-left":"43%","margin-top":"10px"},attrs:{dense:"",round:"",color:"positive","aria-label":"Crop",icon:"crop"},on:{click:t.cropImage}})],1),i("div",{staticClass:"fit absolute-top column justify-center items-center overflow-hidden"},[t.cropped?i("div",[i("div",{staticClass:"overflow-hidden relative-position",style:{width:t.img.width+"px",height:t.img.height+"px"}},[i("div",{staticClass:"content-editable absolute-center z-top full-width"},[t.showEditable?i("div",{class:["text-"+t.text.colors[t.text.iColor],"bg-"+t.text.colors[t.text.iBG],"text-"+t.text.styles[t.text.iStyle],"text-"+t.text.aligns[t.text.iAlign]],style:{"font-family":t.text.families[t.text.iFamily],"font-size":t.text.size+"px"},attrs:{contenteditable:""},on:{paste:function(e){return t.paste(e)},keydown:t.setInput,touchmove:t.move}}):t._e()]),i("img",{class:["cropped-image fixed",t.filter.filters[t.filter.index]],attrs:{src:t.cropped},on:{load:t.setSizes}})])]):i("vue-cropper",{ref:"cropper",attrs:{"drag-mode":"none",src:t.file,"auto-crop-area":1,background:!1,"min-crop-box-height":t.img.cropHeight,"min-crop-box-width":t.img.cropWidth,"view-mode":2}})],1),t.cropped?i("q-page-sticky",{attrs:{position:"bottom-left",offset:[5,45]}},[i("q-fab",{ref:"fab",attrs:{color:"secondary",icon:"title",direction:"right",padding:"sm"},on:{show:t.addEditable,hide:t.preventFabHide},model:{value:t.showFab,callback:function(e){t.showFab=e},expression:"showFab"}},[i("q-fab-action",{staticStyle:{"margin-left":"-6px"},attrs:{color:"primary",icon:"text_format"},on:{click:function(e){t.text.iFamily=t.text.families[t.text.iFamily+1]?t.text.iFamily+1:0}}}),i("q-fab-action",{attrs:{color:"primary",icon:"format_size"},on:{click:function(e){t.text.size=t.text.size>60?16:t.text.size+4}}}),i("q-fab-action",{attrs:{color:"primary",icon:"invert_colors"},on:{click:function(e){t.text.iColor=t.text.colors[t.text.iColor+1]?t.text.iColor+1:0}}}),i("q-fab-action",{attrs:{color:"primary",icon:"check_box_outline_blank"},on:{click:function(e){t.text.iBG=t.text.colors[t.text.iBG+1]?t.text.iBG+1:0}}}),i("q-fab-action",{attrs:{color:"primary",icon:t.filterText.styles[t.text.iStyle]},on:{click:function(e){t.text.iStyle=t.text.styles[t.text.iStyle+1]?t.text.iStyle+1:0}}}),i("q-fab-action",{attrs:{color:"primary",icon:t.filterText.aligns[t.text.iAlign]},on:{click:function(e){t.text.iAlign=t.text.aligns[t.text.iAlign+1]?t.text.iAlign+1:0}}})],1)],1):t._e(),i("q-btn",{staticClass:"absolute-bottom q-ml-sm q-mb-sm z-max",staticStyle:{"background-color":"rgba(0, 0, 0, 0.3)"},attrs:{dense:"","aria-label":"Commentary",icon:"edit"},on:{click:t.showFooter}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showcommentary,expression:"showcommentary"}],staticClass:"footer-commentary fixed-bottom q-py-xs q-pl-xl q-pr-sm z-top"},[i("q-input",{attrs:{dark:"",dense:"",rounded:"",standout:"",autogrow:"",placeholder:"Adicione uma mensagem...",maxlength:"255"},on:{click:function(){return!0}},scopedSlots:t._u([{key:"append",fn:function(){return[t.media.commentary?i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(e){t.media.commentary=null,t.$el.querySelector(".footer-commentary textarea").focus()}}}):t._e()]},proxy:!0}]),model:{value:t.media.commentary,callback:function(e){t.$set(t.media,"commentary",e)},expression:"media.commentary"}})],1)],1)],1)},a=[],s=(i("5319"),i("498a"),i("ddb0"),i("2b3d"),i("95c3")),n=i.n(s),r=(i("6107"),i("ea41")),c=i.n(r),l=i("f303"),m=i("51b0"),d={name:"ImageMessage",components:{VueCropper:n.a},data:()=>({file:null,media:{},result:null,cropped:null,img:{cropWidth:0,cropHeight:0,width:0,height:0},showcommentary:!1,showFab:!1,showEditable:!1,filter:{index:0,filters:["filtro","rock","eureka","london","flipflop","copper","lofi","night","rock","karl","gold","silver","butterfly","introvert"]},filterText:{styles:["title","format_bold","format_italic"],aligns:["format_align_left","format_align_center","format_align_right"]},text:{size:16,iFamily:0,iColor:0,iBG:20,iStyle:0,iAlign:0,families:["Roboto","Lobster","Pacifico","Great Vibes","Architects Daughter"],colors:["white","grey-10","red-10","blue-grey-10","pink-10","green-10","brown-10","purple-10","deep-orange-10","light-green-10","deep-purple-10","orange-10","teal-10","indigo-10","cyan-10","amber-10","blue-10","yellow-10","light-blue-10","lime-10","none"],styles:["normal","bold","italic"],aligns:["left","center","right"]}}),created(){const t=URL.createObjectURL(this.$route.params.file);this.file=t,setTimeout(()=>{URL.revokeObjectURL(t)},5e3),this.img.cropWidth=l["c"].width(document.body)/2,this.img.cropHeight=l["c"].width(document.body)/3},methods:{showFooter:function(){this.showcommentary=!this.showcommentary,this.showcommentary&&setTimeout(()=>{this.$el.querySelector(".footer-commentary textarea").focus()},50)},cropImage:function(){const t=this.$refs.cropper.getCroppedCanvas({maxWidth:720,maxHeight:1024,imageSmoothingQuality:"high"});t.width<this.img.cropWidth||t.height<this.img.cropHeight?(this.$q.notify({type:"negative",position:"top",message:"Imagem muito pequena, escolha uma imagem maior."}),this.$router.go(-1)):(this.result=t,this.cropped=t.toDataURL("image/png"))},setSizes:function(t){this.img.width=t.target.offsetWidth,this.img.height=t.target.offsetHeight},focusOnDiv:function(){this.$el.querySelector("[contenteditable]").focus(),document.execCommand("selectAll",!1,null),document.getSelection().collapseToEnd()},addEditable:function(t){this.showEditable=!0,this.$nextTick(()=>{const t=this.$el.querySelector(".cropped-image"),e=this.$el.querySelector("[contenteditable]");e.style.maxWidth=l["c"].width(t)-10+"px",e.style.maxHeight=l["c"].height(t)-10+"px"})},preventFabHide:function(t){t?(this.showFab=!1,this.showEditable=!1):this.$refs.fab.show()},paste:function(t){t.preventDefault();var e=(t.originalEvent||t).clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)},setInput:function(t){13===t.keyCode&&(t.preventDefault(),document.execCommand("insertHTML",!1,"<br><br>"))},move:function(t){const e=t.targetTouches[0];t.target.parentNode.style.left=e.pageX-l["c"].width(t.target)+this.img.width/2+"px",t.target.parentNode.style.top=e.pageY-l["c"].offset(t.path[2]).top+"px"},send:function(){this.$q.loading.show();const t=this.result,e=t.getContext("2d"),i=this.$el.querySelector(".cropped-image");if(e.filter=l["c"].style(i,"filter"),e.drawImage(i,0,0,t.width,t.height),e.filter="none",this.showEditable){const o=(t.width/i.width).toFixed(2),a=this.$el.querySelector("[contenteditable]");e.fillStyle=l["c"].style(a,"background-color"),e.fillRect((l["c"].offset(a).left-l["c"].offset(i).left)*o,(l["c"].offset(a).top-l["c"].offset(i).top)*o,l["c"].width(a)*o,l["c"].height(a)*o),e.fillStyle=l["c"].style(a,"color"),e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=1,e.shadowColor="rgba(0, 0, 0, 0.3)",c.a.font=this.text.families[this.text.iFamily],c.a.fontSize=this.text.size*o,c.a.lineHeight=this.text.size*o,c.a.align=this.text.aligns[this.text.iAlign],1===this.text.iStyle?(c.a.fontWeight="bold",c.a.fontStyle=""):2===this.text.iStyle?(c.a.fontStyle="italic",c.a.fontWeight=""):(c.a.fontWeight="",c.a.fontStyle="");const s=this.text.iAlign-2;c.a.drawText(e,a.innerText,(l["c"].offset(a).left-l["c"].offset(i).left-s)*o,(l["c"].offset(a).top-l["c"].offset(i).top+2)*o,l["c"].width(a)*o,l["c"].height(a)*o),this.media.message=a.innerText}this.media.image=t.toDataURL("image/png"),this.media.commentary&&this.media.commentary.replace(/\s/g,"").length>0?this.$set(this.media,"commentary",this.media.commentary.replace(/\s{2,}/g," ").trim()):this.media.commentary=null,this.$axios.post("post/page/"+this.$route.params.pageId,this.media).then(t=>{m["a"].notify(this.$route.params.pageTopic,{title:this.$route.params.pageName,body:this.media.commentary||this.media.message||"Nova imagem",image:"https://storage.googleapis.com/cite-pages/pages/"+this.$route.params.pageId+"/"+t.data.post.id+"/"+t.data.post.image,sound:"default"}),this.$router.replace({path:"page",query:{id:this.$route.params.pageId}})})}}},h=d,p=(i("6fce"),i("2877")),f=i("09e3"),g=i("9989"),u=i("65c6"),x=i("9c40"),b=i("2c91"),y=i("de5e"),w=i("c294"),v=i("72db"),k=i("27f9"),q=i("0016"),S=i("eebe"),C=i.n(S),$=Object(p["a"])(h,o,a,!1,null,"609c89d4",null);e["default"]=$.exports;C()($,"components",{QPageContainer:f["a"],QPage:g["a"],QToolbar:u["a"],QBtn:x["a"],QSpace:b["a"],QPageSticky:y["a"],QFab:w["a"],QFabAction:v["a"],QInput:k["a"],QIcon:q["a"]})},"5e32":function(t,e,i){},"6fce":function(t,e,i){"use strict";var o=i("5e32"),a=i.n(o);a.a}}]);