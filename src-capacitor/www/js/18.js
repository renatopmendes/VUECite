(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"921e":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page-container",[a("q-page",{staticClass:"bg-dark text-white"},[a("q-toolbar",{staticClass:"z-max"},[a("q-btn",{attrs:{dense:"",flat:"","aria-label":"Back",icon:"arrow_back"},on:{click:function(t){return e.$router.go(-1)}}}),a("q-space"),a("div",{staticClass:"text-body1"},[e._v("\n        Novo vídeo\n      ")]),a("q-space"),a("q-btn",{attrs:{dense:"",round:"",color:"positive","aria-label":"Send",icon:"send"},on:{click:e.send}})],1),a("div",{staticClass:"q-px-xs fit absolute-top-left column justify-center items-center"},[a("video",{staticClass:"video-media full-width",attrs:{src:e.url,autoplay:"",muted:""},domProps:{muted:!0}})]),a("q-btn",{staticClass:"absolute-bottom q-ml-sm q-mb-sm z-max",staticStyle:{"background-color":"rgba(0, 0, 0, 0.3)"},attrs:{dense:"","aria-label":"Commentary",icon:"edit"},on:{click:e.showFooter}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showcommentary,expression:"showcommentary"}],staticClass:"footer-commentary fixed-bottom q-py-xs q-pl-xl q-pr-sm"},[a("q-input",{attrs:{dark:"",dense:"",rounded:"",standout:"",autogrow:"",placeholder:"Adicione uma mensagem...",maxlength:"255"},on:{click:function(){return!0}},scopedSlots:e._u([{key:"append",fn:function(){return[e.media.commentary?a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(t){e.media.commentary=null,e.$el.querySelector(".footer-commentary textarea").focus()}}}):e._e()]},proxy:!0}]),model:{value:e.media.commentary,callback:function(t){e.$set(e.media,"commentary",t)},expression:"media.commentary"}})],1)],1)],1)},s=[],i=(a("5319"),a("498a"),a("ddb0"),a("2b3d"),a("f303")),r=a("bd2d"),n=a.n(r),c=a("51b0"),m={name:"VideoMessage",data:()=>({file:null,url:null,media:{},showcommentary:!1,blobSize:1048576}),created(){this.file=this.$route.params.file;const e=URL.createObjectURL(this.file);this.url=e,setTimeout(()=>{URL.revokeObjectURL(e)},5e3)},mounted(){const e=this.$el.querySelector(".video-media"),t=i["c"].width(e)/i["c"].height(e),a=i["c"].width(e)>640?640:i["c"].width(e),o=parseInt(a/t,10);n.a.createGIF({video:this.url,gifWidth:a,gifHeight:o,offset:3},e=>{e.error||(this.media.image=e.image)})},methods:{showFooter:function(){this.showcommentary=!this.showcommentary,this.showcommentary&&setTimeout(()=>{this.$el.querySelector(".footer-commentary textarea").focus()},50)},send:function(){this.$el.querySelector(".video-media").pause(),this.$q.loading.show();const e=setInterval(()=>{if(this.media.image){const t=new FileReader;t.onloadend=e=>{this.media.video=e.target.result,this.media.commentary&&this.media.commentary.replace(/\s/g,"").length>0?this.$set(this.media,"commentary",this.media.commentary.replace(/\s{2,}/g," ").trim()):this.media.commentary=null,this.$axios.post("post/page/"+this.$route.params.pageId,this.media).then(e=>{c["a"].notify(this.$route.params.pageTopic,{title:this.$route.params.pageName,body:this.media.commentary||"Vídeo novo",image:"https://storage.googleapis.com/cite-pages/pages/"+this.$route.params.pageId+"/"+e.data.post.id+"/"+e.data.post.image,sound:"default"}),this.$router.replace({path:"page",query:{id:this.$route.params.pageId}})})},t.readAsDataURL(this.file),clearInterval(e)}},500)}}},l=m,d=a("2877"),u=a("09e3"),h=a("9989"),p=a("65c6"),g=a("9c40"),f=a("2c91"),y=a("27f9"),b=a("0016"),w=a("eebe"),v=a.n(w),q=Object(d["a"])(l,o,s,!1,null,null,null);t["default"]=q.exports;v()(q,"components",{QPageContainer:u["a"],QPage:h["a"],QToolbar:p["a"],QBtn:g["a"],QSpace:f["a"],QInput:y["a"],QIcon:b["a"]})}}]);